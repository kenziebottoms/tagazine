{% extends 'zines/base.html' %}

{% block title %}
    {{ zine }} :: Edit
{% endblock %}

{% block editor %}
    <div id="editor">
        <a id="alt_submit">
            <i class="material-icons md-48">save</i>
        </a><br/>
        <a href="{% url 'zine' zine.id %}">
            <i class="material-icons md-48">close</i>
        </a>
    </div>
{% endblock %}

{% block classes %}editor{% endblock %}

{% block body %}
    <form id="edit-zine" name="editZine" method="POST">
        {% for field in form.visible_fields %}
            <div id="{{ field.id_for_label }}">
                <p class="error">
                    {{ field.errors }}
                </p>
                {% if field.id_for_label == "id_cover" %}
                    <img class="preview" src="{{ field.value.url }}"/>
                {% endif %}
                {{ field.label_tag }}
                {{ field }}
            </div>
        {% endfor %}
        {% for field in form.hidden_fields %}
            {{ field }}
        {% endfor %}
        <label>Desc:</label>
        <div id="quill">
            {{ zine.desc|safe }}
        </div>
        {% csrf_token %}
        <input type="submit" value="Submit">
    </form>
{% endblock %}

{% block scripts %}
    <script>
        $('input[type=submit').on('mouseenter focusin', function() {
            updateQuillHiddenInput('id_desc');
        });
        $('#alt_submit').click(function(e) {
            e.preventDefault();
            updateQuillHiddenInput('id_desc');
            $('#edit-zine').submit();
        });
    </script>
{% endblock %}